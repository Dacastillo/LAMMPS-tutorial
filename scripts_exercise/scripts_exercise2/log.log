LAMMPS (2 Aug 2023)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# 2d LJ flow in a channel around an obstacle

# ---------------
# flow variables
# ---------------
variable push index 0.2
variable damp index 0.4
variable compress index 0.6
# ---------------
# settings
# ---------------

units           lj
dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# ---------------
# create simulation box and atoms
# ---------------

lattice		hex 0.7
Lattice spacing in x,y,z = 1.2843567 2.2245711 1.2843567
region		box block 0 40 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.32108918) to (51.374269 22.245711 0.32108918)
  1 by 1 by 1 MPI processor grid
create_atoms	1 box
Created 840 atoms
  using lattice units in orthogonal box = (0 -0.0022245711 -0.32108918) to (51.374269 22.247936 0.32108918)
  create_atoms CPU = 0.001 seconds

mass		* 1.0

# ---------------
# LJ potential
# ---------------

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# ---------------
# define groups
# ---------------

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
120 atoms in group lower
region		2 block INF INF 8.75 INF INF INF
group		upper region 2
120 atoms in group upper
group		boundary union lower upper
240 atoms in group boundary
group		flow subtract all boundary
600 atoms in group flow

set		group lower type 2
Setting atom values ...
  120 settings made for type
set		group upper type 3
Setting atom values ...
  120 settings made for type

# ---------------
# obstacle
# ---------------

region		void sphere 10 4 0 5.01
region		voidout sphere 10 4 0 5 side out

delete_atoms	region void
Deleted 91 atoms, new total = 749
fix             obstacle flow wall/region voidout harmonic 100 0 1.12246

# ---------------
# initial velocities
# ---------------

velocity	boundary set 0.0 0.0 0.0
velocity	flow create 1.0 482748

# ---------------
# fixes for Poiseuille flow and viscous damping
# ---------------

fix		1 all nve
fix		2 lower setforce 0.0 0.0 0.0
fix		3 upper setforce 0.0 NULL 0.0

fix		4 upper aveforce 0.0 ${compress} 0.0
fix		4 upper aveforce 0.0 0.6 0.0
fix		5 flow addforce ${push} 0.0 0.0
fix		5 flow addforce 0.2 0.0 0.0
fix             6 flow viscous ${damp}
fix             6 flow viscous 0.4

fix		7 all enforce2d

# ---------------
# output
# ---------------

compute         tflow flow temp

thermo		1000
thermo_modify	temp tflow
WARNING: Temperature for thermo pressure is not for group all (src/thermo.cpp:527)

dump		1 all custom 500 dump.obstacle id type x y z vx

dump		2 all image 500 image.*.jpg type type 		zoom 1.6 adiam 1.5
dump_modify	2 pad 5

# command for Mac and Linux
dump            3 all movie 500 movie.mpg type type                 zoom 1.6 adiam 1.5

# command for Windows
#dump            3 all movie 500 movie.avi type type #                zoom 1.6 adiam 1.5

dump_modify	3 pad 5

# ---------------
# run
# ---------------

timestep	0.003
run		25000
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 5 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.42246
  ghost atom cutoff = 1.42246
  binsize = 0.71123, bins = 73 32 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.055 | 3.055 | 3.055 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press          Volume    
         0   1              0              0              0.67823765     0.44441112     1143.0857    
      1000   0.41383137    -0.28392405     0             -0.0032480324   0.51724732     1454.914     
      2000   0.1364794     -0.12573504     0             -0.033169572    0.065510094    2080.8347    
      3000   0.11235614    -0.06735845     0              0.0088457122   0.027536808    2990.0113    
      4000   0.10975894    -0.12756793     0             -0.053125286    0.029327201    4169.9402    
      5000   0.10771685    -0.15301337     0             -0.079955747    0.022340206    5633.125     
      6000   0.10549463    -0.216643       0             -0.14509257     0.019919094    7369.7707    
      7000   0.10322086    -0.23257477     0             -0.1625665      0.018549984    9383.8373    
      8000   0.10122538    -0.32793168     0             -0.25927682     0.015504395    11675.325    
      9000   0.098365608   -0.37153137     0             -0.30481611     0.015213815    14244.234    
     10000   0.096216886   -0.39337903     0             -0.32812112     0.014207444    17090.564    
     11000   0.096182261   -0.40716143     0             -0.341927       0.010222451    20214.315    
     12000   0.097241537   -0.41524954     0             -0.34929667     0.0086696255   23615.486    
     13000   0.094600054   -0.45316163     0             -0.38900031     0.0095643698   27294.079    
     14000   0.095425651   -0.48106001     0             -0.41633874     0.0065710042   31250.094    
     15000   0.094752362   -0.48096783     0             -0.41670321     0.0067512006   35483.529    
     16000   0.096156615   -0.43221048     0             -0.36699345     0.0055354826   39994.385    
     17000   0.093877882   -0.50383949     0             -0.44016798     0.0058489465   44782.662    
     18000   0.096741135   -0.3936708      0             -0.32805732     0.0035471143   49848.36     
     19000   0.096438646   -0.44405463     0             -0.37864631     0.0040535358   55191.48     
     20000   0.096241868   -0.44833967     0             -0.38306481     0.0034213078   60812.02     
     21000   0.096451458   -0.41048193     0             -0.34506492     0.0028282461   66709.981    
     22000   0.09724906    -0.43937791     0             -0.37341994     0.0027502093   72885.364    
     23000   0.098084935   -0.3936694      0             -0.32714451     0.0021706068   79338.167    
     24000   0.099137154   -0.36719075     0             -0.2999522      0.0018591997   86068.392    
     25000   0.099684237   -0.34187991     0             -0.27427031     0.0016806382   93076.037    
Loop time of 3.0876 on 1 procs for 25000 steps with 749 atoms

Performance: 2098716.828 tau/day, 8096.901 timesteps/s, 6.065 Matom-step/s
85.0% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30991    | 0.30991    | 0.30991    |   0.0 | 10.04
Neigh   | 0.48759    | 0.48759    | 0.48759    |   0.0 | 15.79
Comm    | 0.046006   | 0.046006   | 0.046006   |   0.0 |  1.49
Output  | 1.3991     | 1.3991     | 1.3991     |   0.0 | 45.31
Modify  | 0.77268    | 0.77268    | 0.77268    |   0.0 | 25.03
Other   |            | 0.07234    |            |       |  2.34

Nlocal:            749 ave         749 max         749 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:             60 ave          60 max          60 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           1723 ave        1723 max        1723 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1723
Ave neighs/atom = 2.3004005
Neighbor list builds = 4595
Dangerous builds = 4044
Total wall time: 0:00:03
