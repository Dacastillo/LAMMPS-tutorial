LAMMPS (2 Aug 2023)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# 2d LJ flow in a channel around an obstacle

# ---------------
# flow variables
# ---------------
variable push index 0.3
variable damp index 0.6
variable compress index 0.9
# ---------------
# settings
# ---------------

units           lj
dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# ---------------
# create simulation box and atoms
# ---------------

lattice		hex 0.7
Lattice spacing in x,y,z = 1.2843567 2.2245711 1.2843567
region		box block 0 40 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.32108918) to (51.374269 22.245711 0.32108918)
  1 by 1 by 1 MPI processor grid
create_atoms	1 box
Created 840 atoms
  using lattice units in orthogonal box = (0 -0.0022245711 -0.32108918) to (51.374269 22.247936 0.32108918)
  create_atoms CPU = 0.000 seconds

mass		* 1.0

# ---------------
# LJ potential
# ---------------

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# ---------------
# define groups
# ---------------

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
120 atoms in group lower
region		2 block INF INF 8.75 INF INF INF
group		upper region 2
120 atoms in group upper
group		boundary union lower upper
240 atoms in group boundary
group		flow subtract all boundary
600 atoms in group flow

set		group lower type 2
Setting atom values ...
  120 settings made for type
set		group upper type 3
Setting atom values ...
  120 settings made for type

# ---------------
# obstacle
# ---------------

region		void sphere 10 4 0 6.01
region		voidout sphere 10 4 0 6 side out

delete_atoms	region void
Deleted 127 atoms, new total = 713
fix             obstacle flow wall/region voidout harmonic 100 0 1.12246

# ---------------
# obstacle
# ---------------

region		void2 sphere 4  6 0 3.01
region		voidout2 sphere 4 6 0 3 side out

delete_atoms	region void2
Deleted 28 atoms, new total = 685
fix             obstacle2 flow wall/region voidout2 harmonic 100 0 1.12246

# ---------------
# initial velocities
# ---------------

velocity	boundary set 0.0 0.0 0.0
velocity	flow create 1.0 482748

# ---------------
# fixes for Poiseuille flow and viscous damping
# ---------------

fix		1 all nve
fix		2 lower setforce 0.0 0.0 0.0
fix		3 upper setforce 0.0 NULL 0.0

fix		4 upper aveforce 0.0 ${compress} 0.0
fix		4 upper aveforce 0.0 0.9 0.0
fix		5 flow addforce ${push} 0.0 0.0
fix		5 flow addforce 0.3 0.0 0.0
fix             6 flow viscous ${damp}
fix             6 flow viscous 0.6

fix		7 all enforce2d

# ---------------
# output
# ---------------

compute         tflow flow temp

thermo		1000
thermo_modify	temp tflow
WARNING: Temperature for thermo pressure is not for group all (src/thermo.cpp:527)

dump		1 all custom 500 dump.obstacle id type x y z vx

dump		2 all image 500 image.*.jpg type type 		zoom 1.6 adiam 1.5
dump_modify	2 pad 5

# command for Mac and Linux
dump            3 all movie 500 movie.mpg type type                 zoom 1.6 adiam 1.5

# command for Windows
#dump            3 all movie 500 movie.avi type type #                zoom 1.6 adiam 1.5

dump_modify	3 pad 5

# ---------------
# run
# ---------------

timestep	0.003
run		25000
Generated 0 of 3 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 5 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.42246
  ghost atom cutoff = 1.42246
  binsize = 0.71123, bins = 73 32 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 3.055 | 3.055 | 3.055 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press          Volume    
         0   1              0              0              0.65839416     0.39454609     1143.0857    
      1000   0.2758511     -0.27168406     0             -0.090065306    0.3320578      1576.0798    
      2000   0.11129367    -0.15732128     0             -0.08404618     0.051534661    2458.8697    
      3000   0.10111527    -0.23515069     0             -0.16857698     0.050481016    3756.6109    
      4000   0.093144609   -0.36295443     0             -0.30162856     0.045958701    5479.0047    
      5000   0.087139671   -0.46798985     0             -0.4106176      0.04304766     7610.0013    
      6000   0.080831564   -0.57645159     0             -0.52323256     0.040090835    10157.129    
      7000   0.079464574   -0.61852776     0             -0.56620875     0.029934189    13120.389    
      8000   0.081118694   -0.636835       0             -0.58342693     0.022863847    16499.781    
      9000   0.073848623   -0.6921032      0             -0.6434817      0.023868195    20295.304    
     10000   0.073379444   -0.74845696     0             -0.70014436     0.017923134    24506.958    
     11000   0.075069089   -0.71747456     0             -0.66804951     0.01424909     29134.744    
     12000   0.070516473   -0.77710827     0             -0.73068063     0.015540075    34178.662    
     13000   0.077783292   -0.65807047     0             -0.60685841     0.009809963    39638.711    
     14000   0.072163887   -0.74952306     0             -0.70201077     0.010224812    45514.892    
     15000   0.072833406   -0.70766877     0             -0.65971568     0.0081476818   51807.204    
     16000   0.077522034   -0.64278692     0             -0.59174686     0.005549862    58515.648    
     17000   0.076793705   -0.66203312     0             -0.6114726      0.0064138406   65640.224    
     18000   0.078548419   -0.58715183     0             -0.53543601     0.005040086    73180.931    
     19000   0.079017967   -0.59963926     0             -0.5476143      0.0043545717   81137.77     
     20000   0.08120816    -0.53337537     0             -0.47990839     0.0033581298   89510.74     
     21000   0.08102007    -0.5387625      0             -0.48541936     0.0033968896   98299.842    
     22000   0.083253259   -0.56128314     0             -0.50646968     0.002812741    107505.08    
     23000   0.083844166   -0.47491612     0             -0.41971361     0.0022633549   117126.44    
     24000   0.083817971   -0.46740915     0             -0.41222389     0.0021156692   127163.94    
     25000   0.085644635   -0.49462136     0             -0.43823343     0.0019160518   137617.56    
Loop time of 2.75925 on 1 procs for 25000 steps with 685 atoms

Performance: 2348460.117 tau/day, 9060.417 timesteps/s, 6.206 Matom-step/s
96.6% CPU use with 1 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31562    | 0.31562    | 0.31562    |   0.0 | 11.44
Neigh   | 0.51448    | 0.51448    | 0.51448    |   0.0 | 18.65
Comm    | 0.045802   | 0.045802   | 0.045802   |   0.0 |  1.66
Output  | 0.92591    | 0.92591    | 0.92591    |   0.0 | 33.56
Modify  | 0.89088    | 0.89088    | 0.89088    |   0.0 | 32.29
Other   |            | 0.06655    |            |       |  2.41

Nlocal:            685 ave         685 max         685 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:             69 ave          69 max          69 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:           1605 ave        1605 max        1605 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 1605
Ave neighs/atom = 2.3430657
Neighbor list builds = 4760
Dangerous builds = 4398
Total wall time: 0:00:02
